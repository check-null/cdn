import{_ as ce,r,a as Q,n as R,o as ge,g as d,V as T,c as $,b as g,d as fe,P as V,e as l,f as ve,w as o,m as s,y as b,A,i as be,F as _e,x as Ve,h as P,G as j,p as I,E as M,M as ye}from"./index-AzjVB3sG.js";import{M as ke}from"./MobilePagination-CZ05O4mD.js";import{u as we}from"./useIsMobile-B-6FJ4UM.js";const he={class:"page-container"},Ce={class:"search-bar"},xe={__name:"index",setup(Ne){const y=r(!1),x=r(!1),S=r([]),N=r(0),u=r(1),k=r(10),{isMobile:K}=we(),w=r([]),f=r(!1),z=r(),L=r([]),h=Q({account:""}),t=Q({id:null,account:"",password:"",nickName:"",gender:2,email:"",qq:"",roleIdList:[],status:1}),G=R(()=>t.id?"编辑用户":"新增用户"),q={account:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},D=R(()=>Math.ceil(N.value/k.value)||1),i=()=>{y.value=!0,P("/sys/user/page",{pageNum:u.value,pageSize:k.value,account:h.account}).then(n=>{S.value=n.data.records||[],N.value=Number(n.data.total)||0,y.value=!1}).catch(()=>{y.value=!1})},O=()=>{P("/sys/role/select").then(n=>{L.value=n.data||[]}).catch(()=>{})},B=()=>{ye(()=>{i()})},H=()=>{u.value>1&&(u.value--,i())},J=()=>{u.value<D.value&&(u.value++,i())},W=n=>{u.value=n,i()},U=()=>{u.value=1,i()},X=()=>{h.account="",U()},Y=n=>{w.value=n.map(e=>e.id)},E=()=>{t.id=null,t.account="",t.password="",t.nickName="",t.gender=2,t.email="",t.qq="",t.roleIdList=[],t.status=1},Z=()=>{E(),q.password=[{required:!0,message:"请输入密码",trigger:"blur"}],f.value=!0},ee=n=>{E(),q.password=[],P("/sys/user/info",{id:n.id}).then(e=>{Object.assign(t,e.data),f.value=!0}).catch(()=>{})},le=()=>{z.value.validate().then(()=>{x.value=!0;const n=t.id?"/sys/user/update":"/sys/user/save";I(n,t).then(()=>{M.success(t.id?"修改成功":"新增成功"),f.value=!1,i()}).catch(()=>{}).finally(()=>{x.value=!1})}).catch(()=>{})},ae=n=>{j.confirm("确定要删除该用户吗？","提示",{type:"warning"}).then(()=>{I("/sys/user/delete",[n.id]).then(()=>{M.success("删除成功"),i()}).catch(()=>{})}).catch(()=>{})},te=()=>{j.confirm(`确定要删除选中的 ${w.value.length} 个用户吗？`,"提示",{type:"warning"}).then(()=>{I("/sys/user/delete",w.value).then(()=>{M.success("删除成功"),i()}).catch(()=>{})}).catch(()=>{})};return ge(()=>{i(),O()}),(n,e)=>{const v=d("el-input"),p=d("el-button"),m=d("el-table-column"),oe=d("el-tag"),ne=d("el-table"),se=d("el-pagination"),c=d("el-form-item"),_=d("el-radio"),F=d("el-radio-group"),de=d("el-option"),ue=d("el-select"),re=d("el-form"),ie=d("el-dialog"),C=T("permission"),pe=T("loading");return g(),$("div",he,[fe("div",Ce,[l(v,{modelValue:h.account,"onUpdate:modelValue":e[0]||(e[0]=a=>h.account=a),placeholder:"账号",clearable:"",class:"search-input",onKeyup:ve(U,["enter"])},null,8,["modelValue"]),l(p,{type:"primary",onClick:U},{default:o(()=>[...e[13]||(e[13]=[s("搜索",-1)])]),_:1}),l(p,{onClick:X},{default:o(()=>[...e[14]||(e[14]=[s("重置",-1)])]),_:1}),V((g(),b(p,{type:"primary",onClick:Z},{default:o(()=>[...e[15]||(e[15]=[s("新增",-1)])]),_:1})),[[C,"user:save"]]),V((g(),b(p,{type:"danger",disabled:!w.value.length,onClick:te},{default:o(()=>[...e[16]||(e[16]=[s("批量删除",-1)])]),_:1},8,["disabled"])),[[C,"user:delete"]])]),V((g(),b(ne,{data:S.value,"element-loading-delay":200,"element-loading-background":"transparent",onSelectionChange:Y,class:"data-table"},{default:o(()=>[l(m,{type:"selection",width:"50"}),l(m,{prop:"account",label:"账号","min-width":"120"}),l(m,{prop:"nickName",label:"昵称","min-width":"100"}),l(m,{prop:"gender",label:"性别",width:"80"},{default:o(({row:a})=>[s(A(a.gender===0?"男":a.gender===1?"女":"保密"),1)]),_:1}),l(m,{prop:"email",label:"邮箱","min-width":"150"}),l(m,{prop:"status",label:"状态",width:"80"},{default:o(({row:a})=>[l(oe,{type:a.status===1?"success":"danger"},{default:o(()=>[s(A(a.status===1?"正常":"停用"),1)]),_:2},1032,["type"])]),_:1}),l(m,{prop:"createTime",label:"创建时间",width:"170"}),l(m,{label:"操作",width:"150",fixed:be(K)?!1:"right"},{default:o(({row:a})=>[V((g(),b(p,{link:"",type:"primary",onClick:me=>ee(a)},{default:o(()=>[...e[17]||(e[17]=[s("编辑",-1)])]),_:1},8,["onClick"])),[[C,"user:update"]]),V((g(),b(p,{link:"",type:"danger",onClick:me=>ae(a),disabled:a.superAdmin===1},{default:o(()=>[...e[18]||(e[18]=[s("删除",-1)])]),_:1},8,["onClick","disabled"])),[[C,"user:delete"]])]),_:1},8,["fixed"])]),_:1},8,["data"])),[[pe,y.value]]),l(se,{"current-page":u.value,"onUpdate:currentPage":e[1]||(e[1]=a=>u.value=a),"page-size":k.value,"onUpdate:pageSize":e[2]||(e[2]=a=>k.value=a),total:N.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",class:"pagination",onSizeChange:B,onCurrentChange:B},null,8,["current-page","page-size","total"]),l(ke,{"current-page":u.value,"total-pages":D.value,onPrev:H,onNext:J,onPageChange:W,class:"mobile-pagination"},null,8,["current-page","total-pages"]),l(ie,{modelValue:f.value,"onUpdate:modelValue":e[12]||(e[12]=a=>f.value=a),title:G.value,width:"500px","close-on-click-modal":!1},{footer:o(()=>[l(p,{onClick:e[11]||(e[11]=a=>f.value=!1)},{default:o(()=>[...e[24]||(e[24]=[s("取消",-1)])]),_:1}),l(p,{type:"primary",loading:x.value,onClick:le},{default:o(()=>[...e[25]||(e[25]=[s("确定",-1)])]),_:1},8,["loading"])]),default:o(()=>[l(re,{ref_key:"formRef",ref:z,model:t,rules:q,"label-width":"80px"},{default:o(()=>[l(c,{label:"账号",prop:"account"},{default:o(()=>[l(v,{modelValue:t.account,"onUpdate:modelValue":e[3]||(e[3]=a=>t.account=a),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),l(c,{label:"密码",prop:"password"},{default:o(()=>[l(v,{modelValue:t.password,"onUpdate:modelValue":e[4]||(e[4]=a=>t.password=a),type:"password",placeholder:t.id?"不修改请留空":"请输入密码","show-password":""},null,8,["modelValue","placeholder"])]),_:1}),l(c,{label:"昵称",prop:"nickName"},{default:o(()=>[l(v,{modelValue:t.nickName,"onUpdate:modelValue":e[5]||(e[5]=a=>t.nickName=a),placeholder:"请输入昵称"},null,8,["modelValue"])]),_:1}),l(c,{label:"性别",prop:"gender"},{default:o(()=>[l(F,{modelValue:t.gender,"onUpdate:modelValue":e[6]||(e[6]=a=>t.gender=a)},{default:o(()=>[l(_,{value:0},{default:o(()=>[...e[19]||(e[19]=[s("男",-1)])]),_:1}),l(_,{value:1},{default:o(()=>[...e[20]||(e[20]=[s("女",-1)])]),_:1}),l(_,{value:2},{default:o(()=>[...e[21]||(e[21]=[s("保密",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"邮箱",prop:"email"},{default:o(()=>[l(v,{modelValue:t.email,"onUpdate:modelValue":e[7]||(e[7]=a=>t.email=a),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),l(c,{label:"QQ",prop:"qq"},{default:o(()=>[l(v,{modelValue:t.qq,"onUpdate:modelValue":e[8]||(e[8]=a=>t.qq=a),placeholder:"请输入QQ"},null,8,["modelValue"])]),_:1}),l(c,{label:"角色",prop:"roleIdList"},{default:o(()=>[l(ue,{modelValue:t.roleIdList,"onUpdate:modelValue":e[9]||(e[9]=a=>t.roleIdList=a),multiple:"",placeholder:"请选择角色",style:{width:"100%"}},{default:o(()=>[(g(!0),$(_e,null,Ve(L.value,a=>(g(),b(de,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"状态",prop:"status"},{default:o(()=>[l(F,{modelValue:t.status,"onUpdate:modelValue":e[10]||(e[10]=a=>t.status=a)},{default:o(()=>[l(_,{value:1},{default:o(()=>[...e[22]||(e[22]=[s("正常",-1)])]),_:1}),l(_,{value:0},{default:o(()=>[...e[23]||(e[23]=[s("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Ie=ce(xe,[["__scopeId","data-v-79d425c9"]]);export{Ie as default};
