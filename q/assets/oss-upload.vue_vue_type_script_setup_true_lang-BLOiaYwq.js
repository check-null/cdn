import{c as B,g as C}from"./index-9CjrkANP.js";import{d as b,a as l,r as t,c as L,o as D,B as n,A as u,h as d,F as c}from"./vlib-Cn1ZCOTB.js";const $=b({__name:"oss-upload",emits:["refreshDataList"],setup(H,{expose:m,emit:f}){const g=f,s=l(!1),r=l(""),a=l(0),i=l(),_=()=>{s.value=!0,r.value=`${B.api}/sys/oss/upload?token=${C()}`,a.value=0,i.value=[]},v=e=>{if(e.type!=="image/jpg"&&e.type!=="image/jpeg"&&e.type!=="image/png"&&e.type!=="image/gif")return c.error("只支持jpg、png、gif格式文件！"),!1;a.value++},x=(e,o,p)=>{if(e.code!==0)return c.error(e.msg);i.value=p,a.value--,a.value===0&&c.success({message:"成功",duration:500,onClose:()=>{s.value=!1,g("refreshDataList")}})};return m({init:_}),(e,o)=>{const p=t("upload-filled"),k=t("el-icon"),y=t("el-upload"),V=t("el-dialog");return D(),L(V,{modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=j=>s.value=j),title:"上传文件","close-on-click-modal":!1,"close-on-press-escape":!1},{default:n(()=>[u(y,{action:r.value,"file-list":i.value,drag:"",multiple:"","before-upload":v,"on-success":x,class:"text-center"},{tip:n(()=>o[1]||(o[1]=[d("div",{class:"el-upload__tip"},"只支持jpg、png、gif格式文件！",-1)])),default:n(()=>[u(k,{class:"el-icon--upload"},{default:n(()=>[u(p)]),_:1}),o[2]||(o[2]=d("div",{class:"el-upload__text"},"将文件拖到此处，或点击上传",-1))]),_:1},8,["action","file-list"])]),_:1},8,["modelValue"])}}});export{$ as _};
