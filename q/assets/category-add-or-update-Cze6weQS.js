import{a as m,q,i as D,r as s,c as O,o as A,B as r,A as a,E as B,C as b,F as _}from"./vlib-Cn1ZCOTB.js";import{_ as P,b as p}from"./index-VyNxZgU2.js";import"./quill-BosuxZz1.js";import"./lodash-CIOfnQPl.js";const T={__name:"category-add-or-update",props:{selectTree:Array,screenSize:Number},emits:["refreshDataList"],setup(c,{expose:y,emit:V}){const k=V,x=c,n=m(!1),d=m(),N={children:"children",label:"categoryName",value:"id"},i=q(()=>{let o=x.screenSize<768;return{top:o?"30vh":"",width:o?"100%":"",closeOnClick:!1,labelPosition:o?"top":"right"}}),t=D({id:"",parentId:"",categoryName:"",sort:"",createDate:"",creator:"",updateDate:"",updater:""}),C=m({parentId:[{required:!0,message:"必填项不能为空",trigger:"blur"}],categoryName:[{required:!0,message:"必填项不能为空",trigger:"blur"}],sort:[{required:!0,message:"必填项不能为空",trigger:"blur"}]}),I=o=>{n.value=!0,t.id="",d.value&&d.value.resetFields(),o&&w(o)},w=o=>{p.get("/demo/category/"+o).then(e=>{Object.assign(t,e.data)})},f=()=>{d.value.validate(o=>{if(!o)return!1;if(d.value.id==t.parentId)return _.error({message:"所选的上级不能是自己",duration:500}),!1;(t.id?p.put:p.post)("/demo/category",t).then(e=>{_.success({message:"成功",duration:500,onClose:()=>{n.value=!1,k("refreshDataList")}})})})};return y({init:I}),(o,e)=>{const F=s("el-tree-select"),u=s("el-form-item"),g=s("el-input"),S=s("el-form"),v=s("el-button"),U=s("el-dialog");return A(),O(U,{modelValue:n.value,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value=l),title:t.id?"修改":"新增","close-on-click-modal":i.value.closeOnClick,width:i.value.width,top:i.value.top},{footer:r(()=>[a(v,{onClick:e[4]||(e[4]=l=>n.value=!1)},{default:r(()=>e[7]||(e[7]=[b("取消")])),_:1}),a(v,{type:"primary",onClick:e[5]||(e[5]=l=>f())},{default:r(()=>e[8]||(e[8]=[b("确定")])),_:1})]),default:r(()=>[a(S,{model:t,rules:C.value,ref_key:"dataFormRef",ref:d,onKeyup:e[3]||(e[3]=B(l=>f(),["enter"])),"label-width":"80px","label-position":i.value.labelPosition},{default:r(()=>[a(u,{label:"上级",prop:"parentId"},{default:r(()=>[a(F,{modelValue:t.parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>t.parentId=l),data:c.selectTree,"check-strictly":"","render-after-expand":!0,props:N,"node-key":"id"},null,8,["modelValue","data"])]),_:1}),a(u,{label:"分类名",prop:"categoryName"},{default:r(()=>[a(g,{modelValue:t.categoryName,"onUpdate:modelValue":e[1]||(e[1]=l=>t.categoryName=l),placeholder:"分类名"},null,8,["modelValue"])]),_:1}),a(u,{label:"排序",prop:"sort"},{default:r(()=>[a(g,{modelValue:t.sort,"onUpdate:modelValue":e[2]||(e[2]=l=>t.sort=l),placeholder:"排序"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules","label-position"])]),_:1},8,["modelValue","title","close-on-click-modal","width","top"])}}},L=P(T,[["__scopeId","data-v-c3b1d4c1"]]);export{L as default};
